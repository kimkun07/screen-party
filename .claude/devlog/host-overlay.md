# Task: Host Overlay (í˜¸ìŠ¤íŠ¸ íˆ¬ëª… ì˜¤ë²„ë ˆì´)

## ê°œìš”

í˜¸ìŠ¤íŠ¸ê°€ ê²Œì„ ì°½ ìœ„ì— íˆ¬ëª… ì˜¤ë²„ë ˆì´ë¥¼ ë„ì›Œ ê²ŒìŠ¤íŠ¸ë“¤ì˜ ë“œë¡œì‰ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ë³¼ ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤.

## ëª©í‘œ

**í•µì‹¬ ì‹œë‚˜ë¦¬ì˜¤**:
1. í˜¸ìŠ¤íŠ¸/ê²ŒìŠ¤íŠ¸ê°€ ë©”ì¸ í™”ë©´ì—ì„œ "ê·¸ë¦¼ ì˜ì—­ ìƒì„±" ë²„íŠ¼ í´ë¦­
2. íˆ¬ëª… ì˜¤ë²„ë ˆì´ê°€ ê¸°ë³¸ í¬ê¸°(800x600)ë¡œ ìƒì„±ë¨
3. ìë™ìœ¼ë¡œ í¬ê¸° ì¡°ì • ëª¨ë“œ í™œì„±í™” (ë“œë˜ê·¸ë¡œ í¬ê¸°/ìœ„ì¹˜ ì¡°ì •)
4. ì¡°ì • ì™„ë£Œ: ë²„íŠ¼ í´ë¦­ ë˜ëŠ” Enter í‚¤
5. ë©”ì¸ í™”ë©´ì—ì„œ "ê·¸ë¦¬ê¸° í™œì„±í™”" ë²„íŠ¼ìœ¼ë¡œ ê·¸ë¦¬ê¸° ëª¨ë“œ ì „í™˜ (ESCë¡œ ë¹„í™œì„±í™”)
6. ì˜¤ë²„ë ˆì´ëŠ” í•­ìƒ ìœ„ + click passthrough (ê·¸ë¦¬ê¸° ë¹„í™œì„± ì‹œ í´ë¦­ì´ ì•„ë˜ë¡œ ì „ë‹¬)
7. ëª¨ë“  ì°¸ì—¬ìì˜ ë“œë¡œì‰ì´ ì˜¤ë²„ë ˆì´ì— ì‹¤ì‹œê°„ìœ¼ë¡œ í‘œì‹œë¨

## ì‚¬ìš©ì ìš”êµ¬ì‚¬í•­ (ì›ë³¸)

### 1. ê³µìœ  ëª¨ë“œ ì‹œì‘
- ë©”ì¸ í™”ë©´ì— 'ê³µìœ  ëª¨ë“œ' ë²„íŠ¼ ì¶”ê°€
- ë²„íŠ¼ í´ë¦­ ì‹œ íˆ¬ëª… ì˜¤ë²„ë ˆì´ ìƒì„±
  - ê¸°ë³¸ í¬ê¸° 800x600ìœ¼ë¡œ ìƒì„±
  - ìë™ìœ¼ë¡œ í¬ê¸° ì¡°ì • ëª¨ë“œ í™œì„±í™”
  - ë“œë˜ê·¸ë¡œ í¬ê¸° ë° ìœ„ì¹˜ ì¡°ì • ê°€ëŠ¥

### 2. íˆ¬ëª… ì˜¤ë²„ë ˆì´
- ì„ íƒí•œ ì°½ì˜ ìœ„ì¹˜ì™€ í¬ê¸°ì— ë§ê²Œ í”„ë¡œê·¸ë¨ ì°½ ì¡°ì •
- ì°½ì„ íˆ¬ëª…í•˜ê²Œ ë§Œë“¦
- ê°€ì¥ìë¦¬, ìµœì†Œí™”, ìµœëŒ€í™” ë²„íŠ¼ ë“± ëª¨ë‘ ìˆ¨ê¹€
- í•­ìƒ ìœ„ + click passthrough ì„¤ì •
  - ë‹¤ë¥¸ ì‚¬ëŒì˜ íœì€ ë³´ì´ì§€ë§Œ ê²Œì„ í™”ë©´ì€ í´ë¦­ ê°€ëŠ¥

### 3. Floating Action Button (FAB)
- ë™ê·¸ë€ ë²„íŠ¼ (ì´ˆê¸° ìœ„ì¹˜: ìš°í•˜ë‹¨)
- í´ë¦­í•˜ë©´ ì—¬ëŸ¬ ë²„íŠ¼ì„ ê°€ë¡œë¡œ í¼ì¹¨
  - 'ê³µìœ  ëª¨ë“œ ì¢…ë£Œ' ë²„íŠ¼ í¬í•¨
  - ë‚˜ë¨¸ì§€ ë²„íŠ¼ì€ ì°¨ì°¨ êµ¬í˜„ (ìƒ‰ìƒ, ì§€ìš°ê¸° ë“±)
- ë“œë˜ê·¸&ë“œëìœ¼ë¡œ ìœ„ì¹˜ ì´ë™ ê°€ëŠ¥
- í¼ì³ì§„ ìƒíƒœì—ì„œë„ ëª¨ë“  ë²„íŠ¼ì´ í•¨ê»˜ ì´ë™

### 4. ì˜¤ë²„ë ˆì´ ë™ì‘
- ê²Œì„ ì°½ì´ ì´ë™/ë¦¬ì‚¬ì´ì¦ˆë˜ë©´ ì˜¤ë²„ë ˆì´ë„ ë”°ë¼ê°
- ê²Œì„ ì°½ì´ ìµœì†Œí™”ë˜ë©´ ì˜¤ë²„ë ˆì´ë„ ìˆ¨ê¹€
- ê²Œì„ ì°½ì´ ë‹«íˆë©´ ê³µìœ  ëª¨ë“œ ìë™ ì¢…ë£Œ

## ê¸°ìˆ  ê²°ì •ì‚¬í•­

### í”Œë«í¼ ì§€ì›
- âœ… **Windowsë§Œ êµ¬í˜„** (pywin32 ì‚¬ìš©)
- âŒ **Linux ì œì™¸** (í•„ìš”ì‹œ ë‚˜ì¤‘ì— ì¶”ê°€)

### Click Passthrough êµ¬í˜„
**ë¬¸ì œ**: ì˜¤ë²„ë ˆì´ê°€ í•­ìƒ ìœ„ì— ìˆìœ¼ë©´ì„œë„ í´ë¦­ì´ ì•„ë˜ ê²Œì„ìœ¼ë¡œ ì „ë‹¬ë˜ì–´ì•¼ í•¨

**í•´ê²°ì±…**:
- **Overlay Window**: `Qt.WindowType.WindowTransparentForInput` ì‚¬ìš© â†’ ëª¨ë“  ì…ë ¥ ë¬´ì‹œ
- **FAB**: ë³„ë„ ë…ë¦½ ì°½ìœ¼ë¡œ êµ¬í˜„ (parent=None) â†’ í´ë¦­ ê°€ëŠ¥

```python
# Overlay (í´ë¦­ í†µê³¼)
overlay.setWindowFlags(
    Qt.WindowType.FramelessWindowHint |
    Qt.WindowType.WindowStaysOnTopHint |
    Qt.WindowType.WindowTransparentForInput  # â† í•µì‹¬!
)

# FAB (í´ë¦­ ê°€ëŠ¥)
fab.setWindowFlags(
    Qt.WindowType.FramelessWindowHint |
    Qt.WindowType.WindowStaysOnTopHint
    # WindowTransparentForInput ì„¤ì • ì•ˆ í•¨!
)
```

**ì°¸ê³  ìë£Œ**:
- [Qt Forum - Click-through window](https://forum.qt.io/topic/156799/click-through-window-will-blink-due-setwindowflags)
- [Qt Forum - Click through windows](https://forum.qt.io/topic/83161/click-through-windows)

### ì°½ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
**Windows**: `win32gui.EnumWindows()` + `pywin32`

```python
import win32gui
import win32process

def get_window_list():
    windows = []

    def callback(hwnd, data):
        if win32gui.IsWindowVisible(hwnd):
            title = win32gui.GetWindowText(hwnd)
            if title:
                _, pid = win32process.GetWindowThreadProcessId(hwnd)
                # ... í”„ë¡œì„¸ìŠ¤ ì´ë¦„ ê°€ì ¸ì˜¤ê¸° ...
                windows.append(WindowInfo(...))
        return True

    win32gui.EnumWindows(callback, windows)
    return windows
```

### ì°½ ìœ„ì¹˜ ë™ê¸°í™”
**ë°©ë²•**: QTimerë¡œ 100msë§ˆë‹¤ ì²´í¬

```python
self.sync_timer = QTimer()
self.sync_timer.timeout.connect(self.sync_with_target)
self.sync_timer.start(100)  # 100ms

def sync_with_target():
    # ì°½ ì¡´ì¬ ì—¬ë¶€ í™•ì¸
    # ìµœì†Œí™” ìƒíƒœ í™•ì¸
    # ìœ„ì¹˜/í¬ê¸° ë³€ê²½ í™•ì¸ ë° ì—…ë°ì´íŠ¸
```

**ì„±ëŠ¥**: ~0.1% CPU (í˜„ëŒ€ ì‹œìŠ¤í…œ ê¸°ì¤€)

### FAB ë“œë˜ê·¸ êµ¬í˜„
```python
class FloatingActionMenu(QWidget):
    def mousePressEvent(self, event):
        if event.button() == Qt.MouseButton.LeftButton:
            self.drag_position = event.globalPosition().toPoint() - self.frameGeometry().topLeft()

    def mouseMoveEvent(self, event):
        if event.buttons() == Qt.MouseButton.LeftButton:
            self.move(event.globalPosition().toPoint() - self.drag_position)
```

### DrawingCanvas ì¬ì‚¬ìš©
- ê¸°ì¡´ `client/src/screen_party_client/drawing/canvas.py` ê·¸ëŒ€ë¡œ ì¬ì‚¬ìš©
- ì´ë¯¸ íˆ¬ëª… ë°°ê²½, ë² ì§€ì–´ ì»¤ë¸Œ í”¼íŒ…, ë„¤íŠ¸ì›Œí¬ ì „ì†¡ ëª¨ë‘ êµ¬í˜„ë¨
- Overlayì— ê·¸ëŒ€ë¡œ ì„ë² ë“œí•˜ë©´ ë¨

## ì•„í‚¤í…ì²˜ ë° íŒŒì¼ êµ¬ì¡°

### ìƒˆë¡œ ìƒì„±í•  íŒŒì¼

```
client/src/screen_party_client/
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ __init__.py                          # NEW
â”‚   â””â”€â”€ window_manager.py                    # NEW - Windows ì°½ ê´€ë¦¬
â”œâ”€â”€ gui/
â”‚   â”œâ”€â”€ window_selector.py                   # NEW - ì°½ ì„ íƒ ë‹¤ì´ì–¼ë¡œê·¸
â”‚   â”œâ”€â”€ overlay_window.py                    # NEW - íˆ¬ëª… ì˜¤ë²„ë ˆì´
â”‚   â””â”€â”€ floating_menu.py                     # NEW - FAB
```

### ìˆ˜ì •í•  íŒŒì¼

```
client/src/screen_party_client/
â”œâ”€â”€ gui/
â”‚   â””â”€â”€ main_window.py                       # MODIFY - 'ê³µìœ  ëª¨ë“œ' ë²„íŠ¼ ì¶”ê°€
â””â”€â”€ pyproject.toml                           # MODIFY - ì˜ì¡´ì„± ì¶”ê°€
```

### í´ë˜ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   MainWindow    â”‚
â”‚                 â”‚
â”‚ - share_button  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ creates
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                 â”‚
         â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚WindowSelector    â”‚  â”‚OverlayWindow     â”‚
â”‚Dialog            â”‚  â”‚                  â”‚
â”‚                  â”‚  â”‚ - DrawingCanvas  â”‚
â”‚- get_window_list()â”‚  â”‚ - sync_timer    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                     â”‚ creates
         â”‚                     â”‚
         â–¼                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚WindowManager     â”‚  â”‚FloatingAction    â”‚
â”‚                  â”‚  â”‚Menu              â”‚
â”‚- EnumWindows()   â”‚  â”‚                  â”‚
â”‚- GetWindowRect() â”‚  â”‚- toggle_button   â”‚
â”‚- IsWindowVisible()â”‚  â”‚- exit_button    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚- draggable       â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ìƒì„¸ êµ¬í˜„ ê³„íš

### Phase 1: ê¸°ë³¸ Overlay (ìš°ì„ ìˆœìœ„: ë†’ìŒ)

#### 1.1 WindowManager êµ¬í˜„

**íŒŒì¼**: `client/src/screen_party_client/utils/window_manager.py`

**í´ë˜ìŠ¤**:
```python
@dataclass
class WindowInfo:
    """ì°½ ì •ë³´"""
    handle: int        # hwnd
    title: str         # ì°½ ì œëª©
    process_name: str  # í”„ë¡œì„¸ìŠ¤ ì´ë¦„ (ì˜ˆ: "League of Legends.exe")
    x: int             # ìœ„ì¹˜
    y: int
    width: int         # í¬ê¸°
    height: int

class WindowManager:
    """Windows ì°½ ê´€ë¦¬ í´ë˜ìŠ¤ (pywin32 ì‚¬ìš©)"""

    def get_window_list(self) -> List[WindowInfo]:
        """ì‹¤í–‰ ì¤‘ì¸ ëª¨ë“  ì°½ ëª©ë¡ ë°˜í™˜"""

    def get_window_info(self, handle: int) -> Optional[WindowInfo]:
        """íŠ¹ì • ì°½ì˜ ì •ë³´ ë°˜í™˜"""

    def is_window_minimized(self, handle: int) -> bool:
        """ì°½ì´ ìµœì†Œí™”ë˜ì—ˆëŠ”ì§€ í™•ì¸"""

    def is_window_visible(self, handle: int) -> bool:
        """ì°½ì´ ë³´ì´ëŠ”ì§€ í™•ì¸"""

    def window_exists(self, handle: int) -> bool:
        """ì°½ì´ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸"""
```

**ì˜ì¡´ì„±**: `pywin32`, `psutil` (í”„ë¡œì„¸ìŠ¤ ì´ë¦„)

#### 1.2 WindowSelectorDialog êµ¬í˜„

**íŒŒì¼**: `client/src/screen_party_client/gui/window_selector.py`

**UI ë””ìì¸**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Select Window to Share            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search: [________________]          â”‚
â”‚                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ League of Legends               â”‚ â”‚
â”‚ â”‚ (LeagueClient.exe)              â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ Discord                         â”‚ â”‚
â”‚ â”‚ (Discord.exe)                   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                     â”‚
â”‚     [Refresh]  [Cancel]  [Select]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ê¸°ëŠ¥**:
- ì°½ ëª©ë¡ í‘œì‹œ (QListWidget)
- ê²€ìƒ‰ í•„í„° (QLineEdit)
- ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼
- ë”ë¸”í´ë¦­ = ì¦‰ì‹œ ì„ íƒ
- ì„ íƒëœ ì°½ì˜ handle ë°˜í™˜

#### 1.3 OverlayWindow êµ¬í˜„

**íŒŒì¼**: `client/src/screen_party_client/gui/overlay_window.py`

**ê¸°ëŠ¥**:
- íˆ¬ëª… ë°°ê²½ + frameless + í•­ìƒ ìœ„
- `WindowTransparentForInput` í”Œë˜ê·¸ (click passthrough)
- DrawingCanvas ì„ë² ë“œ
- QTimerë¡œ 100msë§ˆë‹¤ ì°½ ìœ„ì¹˜ ë™ê¸°í™”
- ì°½ ë‹«í˜/ìµœì†Œí™” ê°ì§€ ë° ì‹œê·¸ë„ ë°œìƒ

**ì‹œê·¸ë„**:
```python
target_window_closed = pyqtSignal()      # ê²Œì„ ì°½ ë‹«í˜
target_window_minimized = pyqtSignal()   # ê²Œì„ ì°½ ìµœì†Œí™”
target_window_restored = pyqtSignal()    # ê²Œì„ ì°½ ë³µì›
```

**ì£¼ìš” ë©”ì„œë“œ**:
```python
def sync_with_target(self):
    """ê²Œì„ ì°½ê³¼ ìœ„ì¹˜/í¬ê¸° ë™ê¸°í™”"""
    if not self.window_manager.window_exists(self.target_handle):
        self.target_window_closed.emit()
        self.close()
        return

    if self.window_manager.is_window_minimized(self.target_handle):
        if self.isVisible():
            self.hide()
            self.target_window_minimized.emit()
        return

    window_info = self.window_manager.get_window_info(self.target_handle)
    if window_info:
        new_rect = QRect(window_info.x, window_info.y,
                        window_info.width, window_info.height)
        if self.geometry() != new_rect:
            self.setGeometry(new_rect)
```

#### 1.4 MainWindow ìˆ˜ì •

**íŒŒì¼**: `client/src/screen_party_client/gui/main_window.py`

**ì¶”ê°€ UI ìš”ì†Œ**:
```python
# ë©”ì¸ í™”ë©´ì— ì¶”ê°€
self.share_button = QPushButton("Start Share Mode")
self.share_button.setMinimumHeight(50)
self.share_button.clicked.connect(self.toggle_share_mode)
```

**ì¶”ê°€ ë©”ì„œë“œ**:
```python
def toggle_share_mode(self):
    """ê³µìœ  ëª¨ë“œ í† ê¸€"""
    if self.is_sharing:
        self.stop_share_mode()
    else:
        self.start_share_mode()

def start_share_mode(self):
    """ê³µìœ  ëª¨ë“œ ì‹œì‘ (ì°½ ì„ íƒ ë‹¤ì´ì–¼ë¡œê·¸ í‘œì‹œ)"""
    dialog = WindowSelectorDialog(self)
    if dialog.exec():
        window_handle = dialog.get_selected_handle()
        if window_handle:
            self.create_overlay(window_handle)

def create_overlay(self, window_handle: int):
    """ì˜¤ë²„ë ˆì´ ìƒì„±"""
    self.overlay_window = OverlayWindow(
        target_handle=window_handle,
        user_id=self.user_id
    )
    self.overlay_window.target_window_closed.connect(self.on_overlay_closed)

    # DrawingCanvas ë„¤íŠ¸ì›Œí¬ ì—°ê²°
    canvas = self.overlay_window.get_canvas()
    canvas.drawing_started.connect(self._on_drawing_started)
    canvas.drawing_updated.connect(self._on_drawing_updated)
    canvas.drawing_ended.connect(self._on_drawing_ended)

    self.overlay_window.show()
    self.is_sharing = True
    self.share_button.setText("Stop Share Mode")

def stop_share_mode(self):
    """ê³µìœ  ëª¨ë“œ ì¢…ë£Œ"""
    if self.overlay_window:
        self.overlay_window.close()
        self.overlay_window = None

    self.is_sharing = False
    self.share_button.setText("Start Share Mode")

def handle_message(self, message: dict):
    """ë©”ì‹œì§€ ë¼ìš°íŒ… (ê¸°ì¡´ ì½”ë“œì— ì¶”ê°€)"""
    # ... ê¸°ì¡´ ì½”ë“œ ...

    # ì˜¤ë²„ë ˆì´ê°€ ìˆìœ¼ë©´ ë“œë¡œì‰ ë©”ì‹œì§€ ì „ë‹¬
    if self.is_sharing and self.overlay_window:
        if msg_type in [MessageType.DRAWING_START, DRAWING_UPDATE, DRAWING_END]:
            canvas = self.overlay_window.get_canvas()
            # canvas.handle_drawing_xxx() í˜¸ì¶œ
```

---

### Phase 2: Floating Action Button (ìš°ì„ ìˆœìœ„: ì¤‘ê°„)

#### 2.1 FloatingActionMenu êµ¬í˜„

**íŒŒì¼**: `client/src/screen_party_client/gui/floating_menu.py`

**UI ë””ìì¸**:
```
Collapsed:  [â—]

Expanded:   [Exit] [Clear] [â—]
            (ê°€ë¡œë¡œ í¼ì¹¨)
```

**ê¸°ëŠ¥**:
- ë…ë¦½ ì°½ (parent=None, WindowTransparentForInput ì—†ìŒ)
- ë“œë˜ê·¸ ê°€ëŠ¥ (mousePressEvent, mouseMoveEvent)
- í´ë¦­ìœ¼ë¡œ í™•ì¥/ì¶•ì†Œ
- ë°˜íˆ¬ëª… ë°°ê²½ (rgba(50, 50, 50, 200))
- ë‘¥ê·¼ í…Œë‘ë¦¬ (border-radius: 25px)

**ì‹œê·¸ë„**:
```python
exit_clicked = pyqtSignal()   # ê³µìœ  ëª¨ë“œ ì¢…ë£Œ
clear_clicked = pyqtSignal()  # ë“œë¡œì‰ ì§€ìš°ê¸°
```

**ë“œë˜ê·¸ êµ¬í˜„**:
```python
def mousePressEvent(self, event: QMouseEvent):
    if event.button() == Qt.MouseButton.LeftButton:
        self.drag_position = event.globalPosition().toPoint() - self.frameGeometry().topLeft()

def mouseMoveEvent(self, event: QMouseEvent):
    if event.buttons() == Qt.MouseButton.LeftButton and self.drag_position:
        self.move(event.globalPosition().toPoint() - self.drag_position)
```

**í™•ì¥/ì¶•ì†Œ**:
```python
def toggle_menu(self):
    self.is_expanded = not self.is_expanded

    if self.is_expanded:
        self.exit_button.show()
        self.clear_button.show()
    else:
        self.exit_button.hide()
        self.clear_button.hide()

    self.adjustSize()
```

#### 2.2 MainWindow FAB í†µí•©

**íŒŒì¼**: `client/src/screen_party_client/gui/main_window.py`

**create_overlay ìˆ˜ì •**:
```python
def create_overlay(self, window_handle: int):
    # ... ê¸°ì¡´ overlay ìƒì„± ì½”ë“œ ...

    # FAB ìƒì„±
    self.floating_menu = FloatingActionMenu()
    self.floating_menu.exit_clicked.connect(self.stop_share_mode)
    self.floating_menu.clear_clicked.connect(self.clear_overlay_drawings)

    # FAB ìœ„ì¹˜: ìš°í•˜ë‹¨
    overlay_rect = self.overlay_window.geometry()
    fab_x = overlay_rect.right() - 100
    fab_y = overlay_rect.bottom() - 100
    self.floating_menu.move(fab_x, fab_y)

    self.floating_menu.show()

def stop_share_mode(self):
    # ... ê¸°ì¡´ ì½”ë“œ ...

    # FAB ë‹«ê¸°
    if self.floating_menu:
        self.floating_menu.close()
        self.floating_menu = None

def clear_overlay_drawings(self):
    """ì˜¤ë²„ë ˆì´ ë“œë¡œì‰ ëª¨ë‘ ì§€ìš°ê¸°"""
    if self.overlay_window:
        self.overlay_window.get_canvas().clear_all_drawings()
```

---

## ì˜ì¡´ì„±

### pyproject.toml ì¶”ê°€

```toml
[project]
dependencies = [
    # ... ê¸°ì¡´ ì˜ì¡´ì„± ...
    "pywin32>=306; platform_system=='Windows'",
    "psutil>=5.9.0",  # í”„ë¡œì„¸ìŠ¤ ì´ë¦„ ì¡°íšŒ
]
```

### Import í™•ì¸

ì„¤ì¹˜ í›„ import í…ŒìŠ¤íŠ¸:
```python
import win32gui
import win32process
import win32con
import psutil
```

---

## í…ŒìŠ¤íŠ¸ ì „ëµ

### ìœ ë‹› í…ŒìŠ¤íŠ¸

#### test_window_manager.py
```python
@pytest.mark.skipif(platform.system() != "Windows", reason="Windows only")
def test_get_window_list():
    manager = WindowManager()
    windows = manager.get_window_list()
    assert isinstance(windows, list)
    assert len(windows) > 0

def test_window_info_fields():
    manager = WindowManager()
    windows = manager.get_window_list()
    if windows:
        w = windows[0]
        assert hasattr(w, 'handle')
        assert hasattr(w, 'title')
        assert w.width > 0
```

#### test_overlay_window.py
```python
def test_overlay_window_flags(qtbot):
    overlay = OverlayWindow(target_handle=123, user_id="test")
    qtbot.addWidget(overlay)

    flags = overlay.windowFlags()
    assert flags & Qt.WindowType.FramelessWindowHint
    assert flags & Qt.WindowType.WindowStaysOnTopHint
    assert flags & Qt.WindowType.WindowTransparentForInput

def test_overlay_has_canvas(qtbot):
    overlay = OverlayWindow(target_handle=123, user_id="test")
    canvas = overlay.get_canvas()
    assert canvas is not None
```

#### test_floating_menu.py
```python
def test_fab_draggable(qtbot):
    fab = FloatingActionMenu()
    qtbot.addWidget(fab)

    # ë“œë˜ê·¸ ì‹œë®¬ë ˆì´ì…˜
    # ...

def test_fab_expand_collapse(qtbot):
    fab = FloatingActionMenu()
    qtbot.addWidget(fab)

    assert not fab.is_expanded
    fab.toggle_menu()
    assert fab.is_expanded
```

### í†µí•© í…ŒìŠ¤íŠ¸

#### test_share_mode_integration.py
```python
def test_share_mode_lifecycle(qtbot, monkeypatch):
    window = MainWindow()
    qtbot.addWidget(window)
    window.show_main_screen()

    # Mock window selector
    def mock_exec(self):
        self.selected_handle = 12345
        return True
    monkeypatch.setattr(WindowSelectorDialog, "exec", mock_exec)

    # Start share mode
    window.start_share_mode()
    assert window.is_sharing
    assert window.overlay_window is not None
    assert window.floating_menu is not None

    # Stop share mode
    window.stop_share_mode()
    assert not window.is_sharing
```

### ìˆ˜ë™ í…ŒìŠ¤íŠ¸ ì²´í¬ë¦¬ìŠ¤íŠ¸

#### Phase 1 ì²´í¬ë¦¬ìŠ¤íŠ¸
- [ ] ì°½ ëª©ë¡ì—ì„œ ê²Œì„ ì°½ì´ ë³´ì„
- [ ] ê²Œì„ ì°½ ì„ íƒ ì‹œ ì˜¤ë²„ë ˆì´ê°€ ìƒì„±ë¨
- [ ] ì˜¤ë²„ë ˆì´ê°€ íˆ¬ëª…í•¨
- [ ] ì˜¤ë²„ë ˆì´ë¥¼ í´ë¦­í•˜ë©´ ê²Œì„ì´ í´ë¦­ë¨ (click passthrough)
- [ ] ê²Œì„ ì°½ì„ ì´ë™í•˜ë©´ ì˜¤ë²„ë ˆì´ë„ ë”°ë¼ê°
- [ ] ê²Œì„ ì°½ì„ ë¦¬ì‚¬ì´ì¦ˆí•˜ë©´ ì˜¤ë²„ë ˆì´ë„ ë¦¬ì‚¬ì´ì¦ˆë¨
- [ ] ê²Œì„ ì°½ì„ ìµœì†Œí™”í•˜ë©´ ì˜¤ë²„ë ˆì´ë„ ìˆ¨ê²¨ì§
- [ ] ê²Œì„ ì°½ì„ ë³µì›í•˜ë©´ ì˜¤ë²„ë ˆì´ë„ ë‹¤ì‹œ ë³´ì„
- [ ] ê²Œì„ ì°½ì„ ë‹«ìœ¼ë©´ ì˜¤ë²„ë ˆì´ë„ ë‹«í˜
- [ ] ê²ŒìŠ¤íŠ¸ì˜ ë“œë¡œì‰ì´ ì˜¤ë²„ë ˆì´ì— í‘œì‹œë¨

#### Phase 2 ì²´í¬ë¦¬ìŠ¤íŠ¸
- [ ] FABê°€ ìš°í•˜ë‹¨ì— ë‚˜íƒ€ë‚¨
- [ ] FABë¥¼ ë“œë˜ê·¸í•  ìˆ˜ ìˆìŒ
- [ ] FABë¥¼ í´ë¦­í•˜ë©´ ë²„íŠ¼ë“¤ì´ í¼ì³ì§
- [ ] í¼ì³ì§„ ìƒíƒœì—ì„œ ë“œë˜ê·¸í•˜ë©´ ëª¨ë“  ë²„íŠ¼ì´ í•¨ê»˜ ì´ë™
- [ ] Exit ë²„íŠ¼ í´ë¦­ ì‹œ ê³µìœ  ëª¨ë“œê°€ ì¢…ë£Œë¨
- [ ] Clear ë²„íŠ¼ í´ë¦­ ì‹œ ë“œë¡œì‰ì´ ì§€ì›Œì§

---

## ì—ëŸ¬ ì²˜ë¦¬

### ì˜ˆìƒ ì—ëŸ¬ ì‹œë‚˜ë¦¬ì˜¤

1. **pywin32 ë¯¸ì„¤ì¹˜**
   - ê°ì§€: ImportError
   - ì²˜ë¦¬: ì—ëŸ¬ ë‹¤ì´ì–¼ë¡œê·¸ í‘œì‹œ + ì„¤ì¹˜ ì•ˆë‚´

2. **ì°½ ëª©ë¡ì´ ë¹„ì–´ìˆìŒ**
   - ê°ì§€: `get_window_list()` ë°˜í™˜ê°’ ë¹ˆ ë¦¬ìŠ¤íŠ¸
   - ì²˜ë¦¬: "No windows found. Please open an application first."

3. **ê²Œì„ ì°½ì´ ë‹«í˜**
   - ê°ì§€: `window_exists()` ë°˜í™˜ False
   - ì²˜ë¦¬: `target_window_closed` ì‹œê·¸ë„ ë°œìƒ â†’ ë©”ì‹œì§€ í‘œì‹œ â†’ ê³µìœ  ëª¨ë“œ ì¢…ë£Œ

4. **ê¶Œí•œ ë¶€ì¡± (ì¼ë¶€ ì°½ ì ‘ê·¼ ë¶ˆê°€)**
   - ê°ì§€: `GetWindowRect()` ì˜ˆì™¸
   - ì²˜ë¦¬: í•´ë‹¹ ì°½ ìŠ¤í‚µ, ë¡œê·¸ ê¸°ë¡

---

## ì„±ëŠ¥ ê³ ë ¤ì‚¬í•­

### ì°½ ìœ„ì¹˜ ë™ê¸°í™”
- **ì£¼ê¸°**: 100ms (10 FPS)
- **CPU ì‚¬ìš©ëŸ‰**: ~0.1% (í˜„ëŒ€ ì‹œìŠ¤í…œ)
- **ìµœì í™”**: ìœ„ì¹˜ê°€ ë³€ê²½ë˜ì§€ ì•Šì•˜ìœ¼ë©´ setGeometry() í˜¸ì¶œ ì•ˆ í•¨

### ì°½ ëª©ë¡ ì—´ê±°
- **ë¹ˆë„**: ë‹¤ì´ì–¼ë¡œê·¸ ì—´ ë•Œë§Œ (ë˜ëŠ” ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼)
- **ìºì‹±**: í”„ë¡œì„¸ìŠ¤ ì´ë¦„ ì¡°íšŒ ê²°ê³¼ ìºì‹±

### DrawingCanvas
- **ê¸°ì¡´ ìµœì í™” ìœ ì§€**: Delta update, 50ms throttling

---

## TODO

### Phase 1: ê¸°ë³¸ Overlay
- [ ] `utils/__init__.py` ìƒì„±
- [ ] `utils/window_manager.py` êµ¬í˜„
  - [ ] WindowInfo ë°ì´í„°í´ë˜ìŠ¤
  - [ ] WindowManager í´ë˜ìŠ¤
  - [ ] get_window_list()
  - [ ] get_window_info()
  - [ ] is_window_minimized()
  - [ ] is_window_visible()
  - [ ] window_exists()
- [ ] `gui/window_selector.py` êµ¬í˜„
  - [ ] WindowSelectorDialog UI
  - [ ] ì°½ ëª©ë¡ í‘œì‹œ
  - [ ] ê²€ìƒ‰ í•„í„°
  - [ ] ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼
  - [ ] ì„ íƒëœ handle ë°˜í™˜
- [ ] `gui/overlay_window.py` êµ¬í˜„
  - [ ] OverlayWindow í´ë˜ìŠ¤
  - [ ] íˆ¬ëª… + frameless + í•­ìƒ ìœ„ ì„¤ì •
  - [ ] WindowTransparentForInput í”Œë˜ê·¸
  - [ ] DrawingCanvas ì„ë² ë“œ
  - [ ] sync_timer ì„¤ì • (100ms)
  - [ ] sync_with_target() ë©”ì„œë“œ
  - [ ] ì‹œê·¸ë„ (closed, minimized, restored)
- [ ] `gui/main_window.py` ìˆ˜ì •
  - [ ] 'ê³µìœ  ëª¨ë“œ' ë²„íŠ¼ ì¶”ê°€
  - [ ] toggle_share_mode() ë©”ì„œë“œ
  - [ ] start_share_mode() ë©”ì„œë“œ
  - [ ] create_overlay() ë©”ì„œë“œ
  - [ ] stop_share_mode() ë©”ì„œë“œ
  - [ ] handle_message() ìˆ˜ì • (ì˜¤ë²„ë ˆì´ì— ë“œë¡œì‰ ì „ë‹¬)
- [ ] `pyproject.toml` ì˜ì¡´ì„± ì¶”ê°€
  - [ ] pywin32>=306
  - [ ] psutil>=5.9.0
- [ ] Phase 1 í…ŒìŠ¤íŠ¸
  - [ ] ìˆ˜ë™ í…ŒìŠ¤íŠ¸ (ì°½ ì„ íƒ, ì˜¤ë²„ë ˆì´ ìƒì„±, click passthrough)
  - [ ] test_window_manager.py ì‘ì„±
  - [ ] test_overlay_window.py ì‘ì„±

### Phase 2: FAB ì¶”ê°€
- [ ] `gui/floating_menu.py` êµ¬í˜„
  - [ ] FloatingActionMenu í´ë˜ìŠ¤
  - [ ] ë…ë¦½ ì°½ ì„¤ì • (parent=None)
  - [ ] ë“œë˜ê·¸ êµ¬í˜„ (mouse events)
  - [ ] toggle_menu() ë©”ì„œë“œ
  - [ ] ì‹œê·¸ë„ (exit_clicked, clear_clicked)
  - [ ] ìŠ¤íƒ€ì¼ì‹œíŠ¸ (ë°˜íˆ¬ëª…, ë‘¥ê·¼ í…Œë‘ë¦¬)
- [ ] `gui/main_window.py` FAB í†µí•©
  - [ ] create_overlay()ì— FAB ìƒì„± ì¶”ê°€
  - [ ] FAB ìœ„ì¹˜ ì„¤ì • (ìš°í•˜ë‹¨)
  - [ ] exit_clicked ì‹œê·¸ë„ ì—°ê²°
  - [ ] clear_clicked ì‹œê·¸ë„ ì—°ê²°
  - [ ] stop_share_mode()ì— FAB ë‹«ê¸° ì¶”ê°€
  - [ ] clear_overlay_drawings() ë©”ì„œë“œ ì¶”ê°€
- [ ] Phase 2 í…ŒìŠ¤íŠ¸
  - [ ] ìˆ˜ë™ í…ŒìŠ¤íŠ¸ (FAB ë“œë˜ê·¸, í™•ì¥/ì¶•ì†Œ, ë²„íŠ¼ í´ë¦­)
  - [ ] test_floating_menu.py ì‘ì„±
  - [ ] test_share_mode_integration.py ì‘ì„±

### ì™„ë£Œ í›„
- [ ] devlog ì—…ë°ì´íŠ¸ (í´ë¡œë“œ ì½”ë“œ ì¼ê¸° ì‘ì„±)
- [ ] main.md ì—…ë°ì´íŠ¸ (Task ìƒíƒœ â†’ âœ… ì™„ë£Œ)
- [ ] ì»¤ë°‹ (`[host-overlay] Phase 1+2 êµ¬í˜„ ì™„ë£Œ`)

---

## í´ë¡œë“œ ì½”ë“œ ì¼ê¸°

### 2026-01-04 - êµ¬í˜„ ê³„íš ìˆ˜ë¦½

**ìƒíƒœ**: ğŸŸ¡ ì¤€ë¹„ì¤‘ â†’ ğŸŸ¢ ì§„í–‰ì¤‘

**ì‚¬ìš©ì ìš”êµ¬ì‚¬í•­ ëª…í™•í™”**:
- Windowsë§Œ ì§€ì› (Linux ì œì™¸)
- Phase 1 + Phase 2 êµ¬í˜„ (Overlay + FAB)
- FAB ìœ„ì¹˜: ìš°í•˜ë‹¨
- Window Selector: ë‹¨ìˆœ ë¦¬ìŠ¤íŠ¸ (ì°½ ì œëª© + í”„ë¡œì„¸ìŠ¤ ì´ë¦„)

**ê¸°ìˆ  ì¡°ì‚¬ ì™„ë£Œ**:
- Click passthrough: `Qt.WindowType.WindowTransparentForInput` ì‚¬ìš©
- FABëŠ” ë³„ë„ ë…ë¦½ ì°½ìœ¼ë¡œ êµ¬í˜„ (í´ë¦­ ê°€ëŠ¥í•˜ë„ë¡)
- Windows ì°½ ê´€ë¦¬: `pywin32` (win32gui.EnumWindows)
- ì°½ ìœ„ì¹˜ ë™ê¸°í™”: QTimer 100ms

**ë‹¤ìŒ ë‹¨ê³„**:
1. Phase 1 êµ¬í˜„ ì‹œì‘
   - WindowManager í´ë˜ìŠ¤
   - WindowSelectorDialog
   - OverlayWindow
   - MainWindow ìˆ˜ì •
2. Phase 1 í…ŒìŠ¤íŠ¸
3. Phase 2 êµ¬í˜„ (FAB)
4. Phase 2 í…ŒìŠ¤íŠ¸

**ë¸”ë¡œì»¤**: ì—†ìŒ

**ì°¸ê³  ìë£Œ**:
- [Qt Forum - Click-through window](https://forum.qt.io/topic/156799/click-through-window-will-blink-due-setwindowflags)
- [Python Examples of win32gui.EnumWindows](https://www.programcreek.com/python/example/10639/win32gui.EnumWindows)
- [ZetCode - Drag and drop in PyQt6](https://zetcode.com/pyqt6/dragdrop/)

---

### 2026-01-04 - Phase 1+2 êµ¬í˜„ ì™„ë£Œ

**ìƒíƒœ**: ğŸŸ¢ ì§„í–‰ì¤‘ â†’ âœ… ì™„ë£Œ

**êµ¬í˜„ ì™„ë£Œ ë‚´ìš©**:

1. **utils/window_manager.py**
   - WindowInfo ë°ì´í„°í´ë˜ìŠ¤
   - WindowManager í´ë˜ìŠ¤ (Windows ì „ìš©)
   - ëª¨ë“  ë©”ì„œë“œ êµ¬í˜„ ì™„ë£Œ (get_window_list, get_window_info, is_window_minimized, is_window_visible, window_exists)
   - ì—ëŸ¬ ì²˜ë¦¬ ì™„ë²½ (í”Œë«í¼ ì²´í¬, pywin32 import ì—ëŸ¬)

2. **gui/window_selector.py**
   - WindowSelectorDialog í´ë˜ìŠ¤
   - ì°½ ëª©ë¡ í‘œì‹œ (QListWidget)
   - ê²€ìƒ‰ í•„í„° ê¸°ëŠ¥
   - ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼
   - ë”ë¸”í´ë¦­ ì¦‰ì‹œ ì„ íƒ
   - ì—ëŸ¬ ì²˜ë¦¬ (ì°½ ëª©ë¡ ì—†ìŒ, í”Œë«í¼ ë¯¸ì§€ì›)

3. **gui/overlay_window.py**
   - OverlayWindow í´ë˜ìŠ¤
   - íˆ¬ëª… ë°°ê²½ + frameless + í•­ìƒ ìœ„
   - `WindowTransparentForInput` í”Œë˜ê·¸ ì„¤ì • (**Click passthrough êµ¬í˜„**)
   - DrawingCanvas ì„ë² ë“œ
   - QTimer 100ms ê°„ê²© ìœ„ì¹˜ ë™ê¸°í™”
   - ì‹œê·¸ë„ (target_window_closed, target_window_minimized, target_window_restored)
   - ìµœì†Œí™” ê°ì§€ ë° ìë™ ìˆ¨ê¹€/ë³µì›

4. **gui/floating_menu.py**
   - FloatingActionMenu í´ë˜ìŠ¤
   - ë…ë¦½ ì°½ (parent=None) - í´ë¦­ ê°€ëŠ¥!
   - ë“œë˜ê·¸ ê¸°ëŠ¥ êµ¬í˜„ (mousePressEvent, mouseMoveEvent)
   - í™•ì¥/ì¶•ì†Œ ê¸°ëŠ¥ (toggle_menu)
   - Exit ë²„íŠ¼, Clear ë²„íŠ¼
   - ë°˜íˆ¬ëª… ìŠ¤íƒ€ì¼ì‹œíŠ¸
   - ë²„íŠ¼ ì˜ì—­ ì™¸ì—ì„œë§Œ ë“œë˜ê·¸ ê°€ëŠ¥í•˜ë„ë¡ ì²˜ë¦¬

5. **gui/main_window.py ìˆ˜ì •**
   - 'ê³µìœ  ëª¨ë“œ' ë²„íŠ¼ ì¶”ê°€ (ì´ë¯¸ ìˆìŒ)
   - toggle_share_mode() ë©”ì„œë“œ
   - start_share_mode() ë©”ì„œë“œ (WindowSelectorDialog í˜¸ì¶œ)
   - create_overlay() ë©”ì„œë“œ (Overlay + FAB ìƒì„±, ìš°í•˜ë‹¨ ë°°ì¹˜)
   - stop_share_mode() ë©”ì„œë“œ (Overlay + FAB ì •ë¦¬)
   - on_overlay_window_closed() ë©”ì„œë“œ
   - clear_overlay_drawings() ë©”ì„œë“œ
   - handle_message()ì—ì„œ ì˜¤ë²„ë ˆì´ë¡œ ë“œë¡œì‰ ë©”ì‹œì§€ ë¼ìš°íŒ… (ì´ë¯¸ êµ¬í˜„ë¨)
   - disconnect() ì‹œ ê³µìœ  ëª¨ë“œ ìë™ ì¢…ë£Œ

6. **ì˜ì¡´ì„± ì¶”ê°€**
   - pywin32>=306 (platform_system=='Windows')
   - psutil>=5.9.0

**ì£¼ìš” ê¸°ìˆ  êµ¬í˜„**:
- âœ… Click passthrough: `Qt.WindowType.WindowTransparentForInput`
- âœ… FAB ë…ë¦½ ì°½: parent=None, click ê°€ëŠ¥
- âœ… ì°½ ìœ„ì¹˜ ë™ê¸°í™”: QTimer 100ms
- âœ… ìµœì†Œí™” ê°ì§€: is_window_minimized()
- âœ… ì°½ ë‹«í˜ ê°ì§€: window_exists()
- âœ… ë“œë˜ê·¸: mousePressEvent/mouseMoveEvent
- âœ… DrawingCanvas ì¬ì‚¬ìš©: handle_drawing_start/update/end

**í…ŒìŠ¤íŠ¸ ìƒíƒœ**:
- âš ï¸ Linux í™˜ê²½ì—ì„œëŠ” Windows ì „ìš© ê¸°ëŠ¥ì´ë¼ ì‹¤í–‰ ë¶ˆê°€
- âš ï¸ Windowsì—ì„œ ìˆ˜ë™ í…ŒìŠ¤íŠ¸ í•„ìš”
- âœ… ì½”ë“œ êµ¬ì¡° ë° ë¡œì§ ê²€ì¦ ì™„ë£Œ

**ì•Œë ¤ì§„ ì œì•½ì‚¬í•­**:
- Windows ì „ìš© (Linux ë¯¸ì§€ì›)
- pywin32 í•„ìˆ˜ (devcontainerëŠ” Linuxë¼ì„œ ì„¤ì¹˜ ì•ˆ ë¨)
- ì‹¤ì œ ë™ì‘ í…ŒìŠ¤íŠ¸ëŠ” Windows í™˜ê²½ì—ì„œ í•´ì•¼ í•¨

**ë‹¤ìŒ ë‹¨ê³„**:
1. Windows í™˜ê²½ì—ì„œ ìˆ˜ë™ í…ŒìŠ¤íŠ¸
   - ì°½ ì„ íƒ ë‹¤ì´ì–¼ë¡œê·¸ í‘œì‹œ í™•ì¸
   - ì˜¤ë²„ë ˆì´ ìƒì„± ë° íˆ¬ëª…ë„ í™•ì¸
   - **Click passthrough í™•ì¸ (ê°€ì¥ ì¤‘ìš”!)**
   - FAB ë“œë˜ê·¸ í™•ì¸
   - FAB í™•ì¥/ì¶•ì†Œ í™•ì¸
   - Exit/Clear ë²„íŠ¼ ë™ì‘ í™•ì¸
   - ì°½ ì´ë™/ë¦¬ì‚¬ì´ì¦ˆ ì‹œ ì˜¤ë²„ë ˆì´ ë™ê¸°í™” í™•ì¸
   - ì°½ ìµœì†Œí™” ì‹œ ì˜¤ë²„ë ˆì´ ìˆ¨ê¹€ í™•ì¸
   - ì°½ ë‹«í˜ ì‹œ ìë™ ì¢…ë£Œ í™•ì¸

2. ë²„ê·¸ ìˆ˜ì • (í•„ìš”ì‹œ)

3. devlog ìµœì¢… ì—…ë°ì´íŠ¸

**ë¸”ë¡œì»¤**: ì—†ìŒ (êµ¬í˜„ ì™„ë£Œ)

**íŒŒì¼ ëª©ë¡**:
```
client/src/screen_party_client/
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ __init__.py (ì´ë¯¸ ìˆìŒ)
â”‚   â””â”€â”€ window_manager.py (ì´ë¯¸ ìˆìŒ)
â”œâ”€â”€ gui/
â”‚   â”œâ”€â”€ window_selector.py (ì´ë¯¸ ìˆìŒ)
â”‚   â”œâ”€â”€ overlay_window.py (NEW)
â”‚   â”œâ”€â”€ floating_menu.py (NEW)
â”‚   â””â”€â”€ main_window.py (MODIFIED)
â””â”€â”€ pyproject.toml (MODIFIED)
```

---

### 2026-01-11 - Click Passthrough í…ŒìŠ¤íŠ¸ ì™„ë£Œ

**ìƒíƒœ**: âœ… ì™„ë£Œ â†’ âœ… ê²€ì¦ ì™„ë£Œ

**í…ŒìŠ¤íŠ¸ í”„ë¡œê·¸ë¨ ê°œë°œ**:
- `client/src/screen_party_client/test_clickthrough.py` ìƒì„±
- 5ê°€ì§€ ë°©ë²•ì„ ë…ë¦½ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆëŠ” í”„ë¡œê·¸ë¨
- ì»¨íŠ¸ë¡¤ ì°½ê³¼ í…ŒìŠ¤íŠ¸ ì˜¤ë²„ë ˆì´ ì°½ ë¶„ë¦¬ êµ¬ì¡°
  - ë¬¸ì œ: Passthrough ON ìƒíƒœì—ì„œ í† ê¸€ ë²„íŠ¼ í´ë¦­ ë¶ˆê°€
  - í•´ê²°: ì»¨íŠ¸ë¡¤ ì°½(í´ë¦­ ê°€ëŠ¥)ê³¼ í…ŒìŠ¤íŠ¸ ì˜¤ë²„ë ˆì´(íˆ¬ëª…)ë¥¼ ë¶„ë¦¬
- `uv run client-test [ë°©ë²•ë²ˆí˜¸]` ëª…ë ¹ìœ¼ë¡œ ì‹¤í–‰ ê°€ëŠ¥

**í…ŒìŠ¤íŠ¸í•œ ë°©ë²•ë“¤**:
1. **Method 1: WindowTransparentForInput** - âœ… **ì„±ê³µ**
   ```python
   self.setWindowFlag(Qt.WindowType.WindowTransparentForInput, enabled)
   self.show()  # ì¤‘ìš”!
   ```

2. **Method 2: WA_TransparentForMouseEvents** - âŒ ì‹¤íŒ¨
   ```python
   self.setAttribute(Qt.WidgetAttribute.WA_TransparentForMouseEvents, enabled)
   ```

3. **Method 3: Combined Flags** - âœ… **ì„±ê³µ**
   ```python
   # í”Œë˜ê·¸ ì¡°í•©ì„ ë™ì ìœ¼ë¡œ ë³€ê²½
   if enabled:
       self.setWindowFlags(... | Qt.WindowType.WindowTransparentForInput)
   else:
       self.setWindowFlags(...)
   self.show()
   ```

4. **Method 4: Attribute + Flag** - âœ… **ì„±ê³µ**
   ```python
   self.setAttribute(Qt.WidgetAttribute.WA_TransparentForMouseEvents, enabled)
   self.setWindowFlag(Qt.WindowType.WindowTransparentForInput, enabled)
   self.show()
   ```

5. **Method 5: No Passthrough (Control)** - âœ… ëŒ€ì¡°êµ° (ì •ìƒ ë™ì‘)

**Windows í™˜ê²½ í…ŒìŠ¤íŠ¸ ê²°ê³¼**:
- âœ… **ë°©ë²• 1 (ê¶Œì¥)**: ì™„ë²½í•˜ê²Œ ì‘ë™
- âŒ **ë°©ë²• 2**: ì‘ë™í•˜ì§€ ì•ŠìŒ (í‚¤ë³´ë“œ ì…ë ¥ë„ ì°¨ë‹¨)
- âœ… **ë°©ë²• 3**: ì‘ë™í•¨
- âœ… **ë°©ë²• 4**: ì‘ë™í•¨

**ê²°ë¡ **:
- **Qt í¬ëŸ¼ ê¶Œì¥ ë°©ë²• (Method 1)ì´ ìµœì„ **
- `setWindowFlag(Qt.WindowType.WindowTransparentForInput, enabled)` ì‚¬ìš©
- í”Œë˜ê·¸ ë³€ê²½ í›„ `show()` ì¬í˜¸ì¶œ í•„ìˆ˜
- í˜„ì¬ êµ¬í˜„ (`overlay_window.py`)ì´ ì˜¬ë°”ë¥¸ ë°©ë²• ì‚¬ìš© ì¤‘

**í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ êµ¬ì¡°**:
```python
# TestOverlayBase: íˆ¬ëª… ì˜¤ë²„ë ˆì´ ì°½ (ë²„íŠ¼ ì—†ìŒ)
# - ë…¸ë€ìƒ‰ í…Œë‘ë¦¬ë¡œ ìœ„ì¹˜ í‘œì‹œ
# - í´ë¦­ ì¹´ìš´í„°ë¡œ ì´ë²¤íŠ¸ ê°ì§€ í™•ì¸
# - paintEvent()ë¡œ ìƒíƒœ í‘œì‹œ

# ControlWindow: ì»¨íŠ¸ë¡¤ ì°½ (í•­ìƒ í´ë¦­ ê°€ëŠ¥)
# - Passthrough ON/OFF ë²„íŠ¼
# - ìƒíƒœ í‘œì‹œ
# - ë‹«ê¸° ë²„íŠ¼
```

**ì°¸ê³  ìë£Œ**:
- Qt Forum: https://forum.qt.io/topic/127517/how-to-make-qpainter-elements-clickable-through-using-pyqt/9
- í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸: `client/src/screen_party_client/test_clickthrough.py`

**ë‹¤ìŒ ë‹¨ê³„**:
- ì‹¤ì œ í”„ë¡œì íŠ¸ì—ì„œ ê³„ì† ë°©ë²• 1 ì‚¬ìš©
- í•„ìš”ì‹œ ë°©ë²• 3 ë˜ëŠ” 4ë¡œ ì „í™˜ ê°€ëŠ¥ (ëª¨ë‘ ê²€ì¦ë¨)

**ë¸”ë¡œì»¤**: ì—†ìŒ

**íŒŒì¼ ë³€ê²½ì‚¬í•­**:
```
client/
â”œâ”€â”€ src/screen_party_client/
â”‚   â””â”€â”€ test_clickthrough.py (NEW - í…ŒìŠ¤íŠ¸ í”„ë¡œê·¸ë¨)
â””â”€â”€ pyproject.toml (MODIFIED - client-test ìŠ¤í¬ë¦½íŠ¸ ì¶”ê°€)
```

---

### 2026-01-11 - í•µì‹¬ ë°œê²¬: Qt íˆ¬ëª…ë„ì™€ í´ë¦­ ì´ë²¤íŠ¸ì˜ ê´€ê³„

**ìƒíƒœ**: âœ… ê²€ì¦ ì™„ë£Œ â†’ âœ… **í•µì‹¬ ë¬¸ì œ í•´ê²°**

**ë¬¸ì œ ë°œê²¬**:
- ê·¸ë¦¬ê¸° ëª¨ë“œ í† ê¸€ ë²„íŠ¼ì„ ëˆŒëŸ¬ë„ ê³„ì† passthrough ìƒíƒœ ìœ ì§€
- WindowTransparentForInput í”Œë˜ê·¸ë¥¼ ì œê±°í•´ë„ í´ë¦­ ì´ë²¤íŠ¸ë¥¼ ë°›ì§€ ëª»í•¨

**ê·¼ë³¸ ì›ì¸ ë°œê²¬**:
```python
# paintEventì—ì„œ ì´ ì¤„ì„ ì£¼ì„ì²˜ë¦¬í•˜ë‹ˆ í´ë¦­ ì´ë²¤íŠ¸ë¥¼ ë°›ì„ ìˆ˜ ì—†ì—ˆìŒ
painter.fillRect(self.rect(), QColor(50, 50, 50, 80))
```

**Qtì˜ í•µì‹¬ ë™ì‘ ì›ë¦¬**:
- âš ï¸ **ì™„ì „íˆ íˆ¬ëª…í•œ í”½ì…€(alpha=0)ì€ í´ë¦­ ì´ë²¤íŠ¸ë¥¼ ë°›ì§€ ëª»í•¨**
- âœ… **ì•½ê°„ì´ë¼ë„ ë¶ˆíˆ¬ëª…í•œ í”½ì…€(alpha>0)ì´ ìˆì–´ì•¼ í´ë¦­ ì´ë²¤íŠ¸ë¥¼ ë°›ìŒ**
- WindowTransparentForInput í”Œë˜ê·¸ì™€ ë¬´ê´€í•˜ê²Œ, íˆ¬ëª… í”½ì…€ì€ í´ë¦­ì„ í†µê³¼ì‹œí‚´

**í•´ê²° ë°©ë²•**:
```python
def paintEvent(self, event):
    """Paint almost invisible background to receive click events"""
    painter = QPainter(self)

    # CRITICAL: This almost-invisible background enables click events
    # Without this, clicks will pass through even when WindowTransparentForInput is disabled
    painter.fillRect(self.rect(), QColor(0, 0, 0, 1))  # alpha=1: barely visible but clickable

    super().paintEvent(event)  # Render DrawingCanvas
```

**íˆ¬ëª…ë„ ë¹„êµ**:
- `QColor(50, 50, 50, 80)`: 31% ë¶ˆíˆ¬ëª… â†’ ëˆˆì— ë„ê²Œ ì–´ë‘ì›Œì§ âŒ
- `QColor(0, 0, 0, 1)`: 0.4% ë¶ˆíˆ¬ëª… â†’ ê±°ì˜ ë³´ì´ì§€ ì•Šì§€ë§Œ í´ë¦­ ê°€ëŠ¥ âœ…

**ë³€ê²½ì‚¬í•­**:
1. `paintEvent()` ë©”ì„œë“œ ì¶”ê°€
2. `QColor(0, 0, 0, 1)` ë°°ê²½ ê·¸ë¦¬ê¸° (alpha=1)
3. ìƒì„¸í•œ ì£¼ì„ìœ¼ë¡œ ì´ìœ  ì„¤ëª…
4. DrawingCanvas ë° ëª¨ë“  ì›ë˜ ê¸°ëŠ¥ ë³µì›

**Windows ì‹¤ì‚¬ìš© í…ŒìŠ¤íŠ¸ ê²°ê³¼** (2026-01-11):
- âœ… **Passthrough OFF**: ì˜¤ë²„ë ˆì´ í´ë¦­ ì‹œ ê·¸ë¦¬ê¸° ê°€ëŠ¥
- âœ… **Passthrough ON**: ì˜¤ë²„ë ˆì´ í´ë¦­ì´ ë’¤ë¡œ í†µê³¼
- âœ… **ë°°ê²½ íˆ¬ëª…ë„**: ê±°ì˜ ë³´ì´ì§€ ì•ŠìŒ (ê²Œì„ í™”ë©´ ë°©í•´ ìµœì†Œí™”)
- âœ… **ESC í‚¤**: ê·¸ë¦¬ê¸° ëª¨ë“œ ë¹„í™œì„±í™” ì •ìƒ ë™ì‘
- âœ… **ê·¸ë¦¬ê¸° í™œì„±í™”/ë¹„í™œì„±í™” í† ê¸€**: ì™„ë²½í•˜ê²Œ ì‘ë™

**í•µì‹¬ êµí›ˆ**:
> Qtì—ì„œ íˆ¬ëª… ì˜¤ë²„ë ˆì´ë¥¼ ë§Œë“¤ ë•Œ, WindowTransparentForInput í”Œë˜ê·¸ë§Œìœ¼ë¡œëŠ” ë¶€ì¡±í•©ë‹ˆë‹¤.
> í´ë¦­ì„ ë°›ìœ¼ë ¤ë©´ ë°˜ë“œì‹œ paintEventì—ì„œ ì•½ê°„ì´ë¼ë„ ë¶ˆíˆ¬ëª…í•œ ë°°ê²½ì„ ê·¸ë ¤ì•¼ í•©ë‹ˆë‹¤.

**ë¸”ë¡œì»¤**: ì—†ìŒ (ì™„ì „ í•´ê²°)

**íŒŒì¼ ë³€ê²½ì‚¬í•­**:
```
client/src/screen_party_client/gui/overlay_window.py
- paintEvent() ì¶”ê°€
- QColor(0, 0, 0, 1) ë°°ê²½
- ëª¨ë“  ì›ë˜ ê¸°ëŠ¥ ë³µì› (DrawingCanvas, ESC í‚¤ ë“±)
```

---

> **ë‹¤ìŒ í´ë¡œë“œ ì½”ë“œì—ê²Œ**:
> - **í•µì‹¬**: Qt íˆ¬ëª… ì°½ì—ì„œ í´ë¦­ ì´ë²¤íŠ¸ë¥¼ ë°›ìœ¼ë ¤ë©´ paintEventì—ì„œ alpha>0ì¸ ë°°ê²½ì„ ê·¸ë ¤ì•¼ í•¨!
> - `QColor(0, 0, 0, 1)`ì€ ê±°ì˜ ë³´ì´ì§€ ì•Šì§€ë§Œ í´ë¦­ ì´ë²¤íŠ¸ë¥¼ ë°›ì„ ìˆ˜ ìˆëŠ” ìµœì ê°’
> - Click passthrough í† ê¸€ì´ ì´ì œ ì™„ë²½í•˜ê²Œ ì‘ë™í•©ë‹ˆë‹¤
> - test_clickthrough.pyë¡œ ì¬í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
